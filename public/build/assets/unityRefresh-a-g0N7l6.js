import{r,W as O,j as e,b as f}from"./app-BUPJ0MyC.js";const K=({DBsync:S})=>{const x="YOUR_SECRET_API_KEY",c=r.useRef(),[p,b]=r.useState(null),[D,C]=r.useState(null),[j,E]=r.useState(null),[g,U]=r.useState(null),[M,P]=r.useState(!0),[k,d]=r.useState(),o=r.useRef(null),[R,T]=r.useState(!1),{data:i,setData:m,post:I}=O({connections:null,Vehicle:null,Device:null,User:null,Reminder:null,Schedule:null}),v=["connections","Vehicle","Device","User","Reminder","Schedule"],h=async(a,s)=>{try{const t=await f({method:"GET",url:`http://localhost:3002${a}`,headers:{"Content-Type":"application/json","api-key":x}}),n=t.data;s(n.data),o.current=n.data,console.log(t.data)}catch(t){o.current=!1,console.error(`Error fetching data from ${a}:`,t)}},u=async(a,s,t)=>{try{const n=await f({method:"POST",url:`http://localhost:3002${a}`,headers:{"Content-Type":"application/json","api-key":x},data:s}),l=n.data;t(l.data),o.current=!0,console.log(n.data)}catch(n){o.current=!1,console.error(`Error fetching data from ${a}:`,n)}},V=()=>{h("/api/users",b),h("/api/devices",C),h("/api/connections",E),h("/api/vehicles",U),console.log("retriveDataFromMongoDB"),T(!0)},_=(a,s)=>{a.preventDefault();const{key:t,value:n}=s;m(l=>({...l,[t]:n}))},B=()=>{console.log("retriveDataFromMariaDB"),c.current=S};r.useEffect(()=>(V(),()=>{}),[R]),r.useEffect(()=>(c.current=[],B(),()=>{c.current=[]}),[]);const F=a=>{a.preventDefault();try{u("/api/connections",{type:"addConnectin",message:"syncData",data:i.connections},d),u("/api/vehicles",{type:"addvehicles",message:"syncData",data:i.Vehicle},d),u("/api/devices",{type:"adddevices",message:"syncData",data:i.Device},d),u("/api/login",{type:"addUser",message:"syncData",data:i.User},d)}catch{console.log(i)}},N=()=>{console.log(i),c.current&&c.current.map((a,s)=>{m(t=>({...t,[v[s]]:a}))})};return e.jsx(e.Fragment,{children:M&&e.jsxs("div",{className:"grid grid-cols-3 p-12",children:[e.jsxs("div",{className:"MongoData bg-gray-300 p-4 rounded m-2",children:[o.current?e.jsx("h1",{children:"Unity MongoDB sync:authorized"}):e.jsx("h1",{children:"Unity MongoDB sync:Unauthorized"}),e.jsx("div",{children:e.jsxs("ul",{children:[p&&e.jsxs("li",{children:[e.jsx("h3",{children:"User Data:"}),e.jsx("ul",{children:p&&p.map((a,s)=>e.jsx("li",{children:a._id},s))})]}),D&&e.jsxs("li",{children:[e.jsx("h3",{children:"Devices Data:"}),e.jsx("ul",{children:D&&D.map((a,s)=>e.jsx("li",{children:a._id},s))})]}),j&&e.jsxs("li",{children:[e.jsx("h3",{children:"Connections Data:"}),e.jsx("ul",{children:j&&j.map((a,s)=>e.jsx("li",{children:a._id},a._id))})]}),g&&e.jsxs("li",{children:[e.jsx("h3",{children:"Vehicles Data:"}),e.jsx("ul",{children:g.map((a,s)=>e.jsx("li",{children:a._id},s))})]})]})})]}),e.jsx("div",{className:"MariaData bg-gray-300 p-4 rounded m-2",children:e.jsx("ul",{children:c.current&&c.current.map((a,s)=>e.jsx("li",{children:e.jsxs("ul",{children:[e.jsxs("li",{children:["---------------:",v[s],":-------------"]}),a.map((t,n)=>e.jsxs("li",{children:[" ",e.jsx("ul",{children:Object.entries(t).map(([l,y],$)=>e.jsx("li",{onClick:A=>{_(A,{key:l,value:y})},children:`KEY:${l} | Value:${y}`},$))},n)]},n))]})},s))})}),e.jsx("div",{className:"action",children:i.connections?e.jsx("form",{onSubmit:F,children:e.jsx("button",{className:"bg-orange-500 p-4 hover:bg-orange-300 rounded",children:"SyncDATA"})}):e.jsx("button",{className:"bg-orange-500 p-4 hover:bg-orange-300 rounded",onClick:N,children:"CleanDATA"})})]})})};export{K as default};
