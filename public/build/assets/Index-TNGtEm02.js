import{r as u,j as t}from"./app-BUPJ0MyC.js";import{c as d}from"./client-C8N3uvOR.js";const g=()=>{const r=d("unityPreview");return r.addEventListener("open",i=>{console.log("clientReady")}),r.addEventListener("message",i=>{messageRef.current=i.data;const s=JSON.parse(messageRef.current);messageType.current=s.message;try{messageType.current.message,messageType.current,messageType.current.type}catch{return}}),r},m=(r,i)=>{var s=!1,o={x:0,y:0},n=r;function c(e){s=!0,o.x=e.clientX-n.getBoundingClientRect().left,o.y=e.clientY-n.getBoundingClientRect().top,n.addEventListener("mousemove",p),n.addEventListener("mouseup",a),n.style.cursor="grabbing"}function p(e){if(s){n.style.left=e.clientX-o.x+"px",n.style.top=e.clientY-o.y+"px";const l={position:{x:e.clientX-o.x,y:e.clientY-o.y}};i.send(JSON.stringify({type:"movingPart",message:e.target.getAttribute("title"),data:l}))}}function a(){s=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",a),n.style.cursor="grab"}n.addEventListener("mousedown",e=>{c(e)})},f=async r=>{try{return await(await fetch(r)).json()}catch(i){throw console.error("Error fetching or parsing JSON:",i),i}},y=r=>{const i=document.querySelector(".place");i.innerHTML="",r.forEach((s,o)=>{const n=document.createElement("span");n.setAttribute("title","Device:"+s.name);const c="rgb("+(225-s.position.x)+","+(225-s.position[1].y)+","+(225-s.position[2].z)+")";n.classList.add("placement");const p={position:{x:s.position.x,y:s.position.y,z:s.position.z}};n.setAttribute("style","right:"+(25-p.position.x*10)+"rem; top:"+(20-p.position.z*10)+"rem; background:"+c+";"),i.append(n)})},v=async r=>{const i=[],s="../spawn.json";console.log("retrive from json");try{const o=await f(s),n=document.querySelector(".place");n.innerHTML="",o.data.devicesSp.forEach((c,p)=>{const a=document.createElement("span"),e={position:{x:c.position.x,y:c.position.y,z:c.position.z}};i.push(e),m(a,r),a.setAttribute("value",JSON.stringify({data:e})),a.setAttribute("title","Device:"+c.name);const l="rgb("+(225-c.position.x)+","+(225-c.position.y)+","+(225-c.position.z)+")";a.classList.add("placement"),a.setAttribute("style","right:"+(25-e.position.x*10)+"rem; top:"+(20-e.position.z*10)+"rem; background:"+l+";"),n.append(a)})}catch(o){console.log(o)}return i},j=()=>{const r=u.useRef(!1),[i,s]=u.useState([]),[o,n]=u.useState(!1);u.useRef();const c=u.useRef([]);u.useRef(),u.useRef();const p=u.useRef();async function a(){o?(y(c.current,p.current),console.log(c.current)):(r.current=await v(p.current),s(r.current))}return u.useEffect(()=>{p.current=g()},[]),u.useEffect(()=>{a()},[o]),t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Devices Placemnt:"}),o?t.jsxs(t.Fragment,{children:[t.jsx("h2",{children:"Retrive from Unity Live Client"}),t.jsx("ul",{children:c.current.map((e,l)=>t.jsx("li",{children:`ID:${l} position: Vector3 (x:${e.position.x},y:${e.position.y},z:${e.position.z})`},l))})]}):t.jsx(t.Fragment,{children:r.current?t.jsxs(t.Fragment,{children:[t.jsx("h2",{children:"Retrive from json Generated file"}),r.current&&t.jsx("ul",{children:r.current.map((e,l)=>t.jsx("li",{children:`ID:${l} position: Vector3 (x:${e.position.x},y:${e.position.y},z:${e.position.z})`},l))})]}):t.jsx(t.Fragment,{children:t.jsx("h2",{children:"Retrive from Unity Live Client, jsonFail"})})}),t.jsx("div",{className:"place"}),t.jsx("style",{children:`
            .placement{
                position:absolute;
                display:block;
                width:4rem;
                height:4rem;
            }
            .placement:hover{
                background:red !important;
            }
            
            `})]})};export{j as default};
